apps:
  http:
    servers:
      main:
        listen: [":80", ":443"]
        routes:
          # Main website - route to blue-green containers with health checks
          - match:
            - host: ["renekris.dev"]
            handle:
            - handler: reverse_proxy
              upstreams:
              - dial: "renekris-web-blue:8080"
              - dial: "renekris-web-green:8080"
              health_checks:
                active:
                  uri: "/health"
                  interval: "10s"
                  timeout: "5s"
              load_balancing:
                selection_policy:
                  name: "first"
          # Status/monitoring subdomain
          - match:
            - host: ["status.renekris.dev"]
            handle:
            - handler: reverse_proxy
              upstreams:
              - dial: "uptime-kuma:3001"
  layer4:
    servers:
      minecraft:
        listen: [":25565"]
        routes:
        - handle:
          - handler: proxy
            upstreams:
            - dial: ["192.168.1.232:25565"]
      tarkov:
        listen: [":6969"]
        routes:
        - handle:
          - handler: proxy
            upstreams:
            - dial: ["192.168.1.234:6969"]